<!DOCTYPE html>





<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="当前项目react-native的版本是0.53.3，因为最近在做一系列性能优化的工作，于是计划升级一下RN的版本，升级至0.56.0。先看一下ReactNative0.56.0版本更新的内容：https://github.com/react-native-community/react-native-releases/blob/master/CHANGELOG.md#056步骤及遇到的问题如下：">
<meta name="keywords" content="ReactNative,前端">
<meta property="og:type" content="article">
<meta property="og:title" content="react-native升级0.56注意问题">
<meta property="og:url" content="http://yoursite.com/2018/11/13/react-native升级0-56/index.html">
<meta property="og:site_name" content="Code change the World">
<meta property="og:description" content="当前项目react-native的版本是0.53.3，因为最近在做一系列性能优化的工作，于是计划升级一下RN的版本，升级至0.56.0。先看一下ReactNative0.56.0版本更新的内容：https://github.com/react-native-community/react-native-releases/blob/master/CHANGELOG.md#056步骤及遇到的问题如下：">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/3112038-ba13577686ed0498.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/3112038-95dc5cf1efb878b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/3112038-138910d1d1bb7a88.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-11-19T04:47:35.792Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="react-native升级0.56注意问题">
<meta name="twitter:description" content="当前项目react-native的版本是0.53.3，因为最近在做一系列性能优化的工作，于是计划升级一下RN的版本，升级至0.56.0。先看一下ReactNative0.56.0版本更新的内容：https://github.com/react-native-community/react-native-releases/blob/master/CHANGELOG.md#056步骤及遇到的问题如下：">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/3112038-ba13577686ed0498.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  <link rel="canonical" href="http://yoursite.com/2018/11/13/react-native升级0-56/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>react-native升级0.56注意问题 | Code change the World</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Code change the World</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">人、技术、职场生活</p>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/13/react-native升级0-56/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Wayne214">
      <meta itemprop="description" content="ReactNative、React、JavaScript、Android、Python、小程序">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Code change the World">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">react-native升级0.56注意问题

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-11-13 17:40:56" itemprop="dateCreated datePublished" datetime="2018-11-13T17:40:56+08:00">2018-11-13</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2018-11-19 12:47:35" itemprop="dateModified" datetime="2018-11-19T12:47:35+08:00">2018-11-19</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/技术分享/" itemprop="url" rel="index"><span itemprop="name">技术分享</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>当前项目react-native的版本是0.53.3，因为最近在做一系列性能优化的工作，于是计划升级一下RN的版本，升级至0.56.0。<br>先看一下ReactNative0.56.0版本更新的内容：<br><a href="https://github.com/react-native-community/react-native-releases/blob/master/CHANGELOG.md#056" target="_blank" rel="noopener">https://github.com/react-native-community/react-native-releases/blob/master/CHANGELOG.md#056</a><br>步骤及遇到的问题如下：</p>
<h2 id="1-使用https-reactnative-cn-docs-upgrading-中基于Git的自动合并更新方式："><a href="#1-使用https-reactnative-cn-docs-upgrading-中基于Git的自动合并更新方式：" class="headerlink" title="1.使用https://reactnative.cn/docs/upgrading/中基于Git的自动合并更新方式："></a>1.使用<a href="https://reactnative.cn/docs/upgrading/中基于Git的自动合并更新方式：" target="_blank" rel="noopener">https://reactnative.cn/docs/upgrading/中基于Git的自动合并更新方式：</a></h2><p>首先全局安装react-native-git-upgrade工具模块：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g react-native-git-upgrade</span><br></pre></td></tr></table></figure>

<a id="more"></a>
<h2 id="2-接下来进行更新操作"><a href="#2-接下来进行更新操作" class="headerlink" title="2.接下来进行更新操作"></a>2.接下来进行更新操作</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ react-native-git-upgrade</span><br><span class="line"># 这样会直接把react native升级到最新版本</span><br><span class="line"></span><br><span class="line"># 或者是：</span><br><span class="line"></span><br><span class="line">$ react-native-git-upgrade X.Y.Z</span><br><span class="line"># 这样把react native升级到指定的X.Y.Z版本</span><br></pre></td></tr></table></figure>

<p>那么更新到0.56.0就是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ react-naitve-git-update 0.56.0</span><br></pre></td></tr></table></figure>

<h2 id="3-等待升级结束后，需要解决冲突-下面的这些文件的冲突都需要进行解决一下"><a href="#3-等待升级结束后，需要解决冲突-下面的这些文件的冲突都需要进行解决一下" class="headerlink" title="3.等待升级结束后，需要解决冲突, 下面的这些文件的冲突都需要进行解决一下"></a>3.等待升级结束后，需要解决冲突, 下面的这些文件的冲突都需要进行解决一下</h2><p><img src="https://upload-images.jianshu.io/upload_images/3112038-ba13577686ed0498.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">文件中的冲突会以分隔线隔开，并清楚的标记出处，例如下面这样：</span><br><span class="line"></span><br><span class="line">13B07F951A680F5B00A75B9A /* Release */ = &#123;</span><br><span class="line">  isa = XCBuildConfiguration;</span><br><span class="line">  buildSettings = &#123;</span><br><span class="line">    ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon;</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;&lt;&lt; ours</span><br><span class="line">    CODE_SIGN_IDENTITY = &quot;iPhone Developer&quot;;</span><br><span class="line">    FRAMEWORK_SEARCH_PATHS = (</span><br><span class="line">      &quot;$(inherited)&quot;,</span><br><span class="line">      &quot;$(PROJECT_DIR)/HockeySDK.embeddedframework&quot;,</span><br><span class="line">      &quot;$(PROJECT_DIR)/HockeySDK-iOS/HockeySDK.embeddedframework&quot;,</span><br><span class="line">    );</span><br><span class="line">=======</span><br><span class="line">    CURRENT_PROJECT_VERSION = 1;</span><br><span class="line">&gt;&gt;&gt;&gt;&gt;&gt;&gt; theirs</span><br><span class="line">    HEADER_SEARCH_PATHS = (</span><br><span class="line">      &quot;$(inherited)&quot;,</span><br><span class="line">      /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include,</span><br><span class="line">      &quot;$(SRCROOT)/../node_modules/react-native/React/**&quot;,</span><br><span class="line">      &quot;$(SRCROOT)/../node_modules/react-native-code-push/ios/CodePush/**&quot;,</span><br><span class="line">    );</span><br><span class="line">上面代码中的&quot;ours&quot;表示你自己的代码，而&quot;theirs&quot;表示 React Native 的官方代码。然后你可以根据实际情况判断，选择某一方晋级，另一方出局。</span><br></pre></td></tr></table></figure>

<h2 id="注意问题"><a href="#注意问题" class="headerlink" title="注意问题"></a>注意问题</h2><p>一、0.56.0以上的RN使用Babel 7</p>
<blockquote>
<p>React Native now uses Babel 7<br>When upgrading to 0.56, make sure to bump your babel-preset-react-native package.json dependency to 5.0.2 or newer (but still as fixed value).<br>React Native 现在使用 Babel 7，升级到 0.56 后，请确保将 babel-preset-react-native package.json 依赖项升级到 ^5.0.2 或更高版本。<br>那么就需要升级一下babel-preset-react-native版本</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add babel-preset-react-native@5.0.2 --dev</span><br></pre></td></tr></table></figure>

<p>二、升级后遇到react native version mismatch问题<br><img src="https://upload-images.jianshu.io/upload_images/3112038-95dc5cf1efb878b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="reactnativeversionmismatch.png"></p>
<p>参考了<a href="https://stackoverflow.com/questions/47763824/react-native-version-mismatch中的解决方案：" target="_blank" rel="noopener">https://stackoverflow.com/questions/47763824/react-native-version-mismatch中的解决方案：</a><br>1.IOS<br>进入项目中： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ios &amp;&amp; pod install</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">For others with the same problem on iOS with CocoaPods:</span><br><span class="line"></span><br><span class="line">I tried all of the solutions above, without luck. I have some packages with native dependencies in my project, and some of those needed pod modules being installed. The problem was that React was specified in my Podfile, but the React pod didn&apos;t automatically get upgraded by using react-native-git-upgrade.</span><br><span class="line"></span><br><span class="line">The fix is to upgrade all installed pods, by running cd ios &amp;&amp; pod install.</span><br></pre></td></tr></table></figure>

<p>2.Android<br><img src="https://upload-images.jianshu.io/upload_images/3112038-138910d1d1bb7a88.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<blockquote>
<p>第三方库使用的buildToolsVersion版本太低，不需要手动修改库内容，在android/build.gradle中添加以下内容，强制所有依赖使用相同版本。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">subprojects &#123;</span><br><span class="line">   afterEvaluate &#123;project -&gt;</span><br><span class="line">       if (project.hasProperty(&quot;android&quot;)) &#123;</span><br><span class="line">           android &#123;</span><br><span class="line">               compileSdkVersion 26</span><br><span class="line">               buildToolsVersion &apos;26.0.3&apos;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="其他升级问题可参考这篇文章-也可在评论区与我进行沟通。"><a href="#其他升级问题可参考这篇文章-也可在评论区与我进行沟通。" class="headerlink" title="其他升级问题可参考这篇文章,也可在评论区与我进行沟通。"></a>其他升级问题可参考这篇文章,也可在评论区与我进行沟通。</h2><p><a href="https://github.com/CodingPapi/blog/issues/1" target="_blank" rel="noopener">ReactNative从0.47 升级到0.56遇到的问题</a></p>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/ReactNative/" rel="tag"># ReactNative</a>
            
              <a href="/tags/前端/" rel="tag"># 前端</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2018/11/08/reactnative小白入门教程-搭建开发环境/" rel="next" title="reactnative入门教程-搭建开发环境">
                  <i class="fa fa-chevron-left"></i> reactnative入门教程-搭建开发环境
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2018/11/19/好用到炸的ReactNaitveUI库/" rel="prev" title="好用到炸的ReactNaitveUI库">
                  好用到炸的ReactNaitveUI库 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-使用https-reactnative-cn-docs-upgrading-中基于Git的自动合并更新方式："><span class="nav-number">1.</span> <span class="nav-text">1.使用https://reactnative.cn/docs/upgrading/中基于Git的自动合并更新方式：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-接下来进行更新操作"><span class="nav-number">2.</span> <span class="nav-text">2.接下来进行更新操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-等待升级结束后，需要解决冲突-下面的这些文件的冲突都需要进行解决一下"><span class="nav-number">3.</span> <span class="nav-text">3.等待升级结束后，需要解决冲突, 下面的这些文件的冲突都需要进行解决一下</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注意问题"><span class="nav-number">4.</span> <span class="nav-text">注意问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他升级问题可参考这篇文章-也可在评论区与我进行沟通。"><span class="nav-number">5.</span> <span class="nav-text">其他升级问题可参考这篇文章,也可在评论区与我进行沟通。</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Wayne214</p>
  <div class="site-description" itemprop="description">ReactNative、React、JavaScript、Android、Python、小程序</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">32</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">tags</span>
        </a>
      </div>
    
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wayne214</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.4.1</div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.1"></script><script src="/js/motion.js?v=7.4.1"></script>
<script src="/js/schemes/muse.js?v=7.4.1"></script>
<script src="/js/next-boot.js?v=7.4.1"></script>



  





















  

  

  

</body>
</html>
